#!/bin/bash
cd $( dirname $0 )

# Fichier VERSION est-il present
[ ! -f ../VERSION ] && echo "fichier ../VERSION absent" && exit 

# La VERSION ne doit pas exister dans les tags préexistants
git tag | grep -q $( cat ../VERSION ) && echo "Le tag $( cat ../VERSION ) existe déjà" && exit 1


[ "$1" = "" ] && echo "Commentaire du commit attendu en premier argument" && exit 1
git commit -m "$1"
git tag -a "$( cat ../VERSION )" -m "tag $( cat ../VERSION )"
git push
git push origin $( cat ../VERSION ) 



exit 0
